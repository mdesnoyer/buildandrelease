
# Define the possible sinks. They are in a failover group where the collector 
# ips are first.
<%= @agent %>.sinkgroups.<%= @kg %>.processor_type = failover
<%= @agent %>.sinkgroups.<%= @kg %>.sinks = <%= @sinks.map{ |x| x[:name]}.join(" " %>
<% @sinks.each do |sink|  %>
  <%= @agent %>.sinks.<%= sink[:name] %>.type = avro
  <%= @agent %>.sinks.<%= sink[:name] %>.channel = <%= @c %>
  <%= @agent %>.sinks.<%= sink[:name] %>.hostname = <%= sink[:ip] %>
  <%= @agent %>.sinks.<%= sink[:name] %>.port = <%= @collector_port %>
  <%= @agent %>.sinkgroups.<%= @kg %>.priority.<%= sink[:name] %>.priority = <%= sink[:priority] %>
<% end %>

# The source is just reading a log file
<%= @agent %>.sources.<%= @s %>.type = exec
<%= @agent %>.sources.<%= @s %>.channels = chan1
<%= @agent %>.sources.<%= @s %>.command = /usr/bin/tail -F <%= @source_file %>
<%= @agent %>.sources.<%= @s %>.restart = true

# Add metadata to the event
<%= @agent %>.sources.<%= @s %>.interceptors = addhost addtime
<%= @agent %>.sources.<%= @s %>.interceptors.addhost.type = static
<%= @agent %>.sources.<%= @s %>.interceptors.addhost.key = srchost
<%= @agent %>.sources.<%= @s %>.interceptors.addhost.value = <%= @hostname %>
<%= @agent %>.sources.<%= @s %>.interceptors.addtime.type = timestamp

# The channel is in memory
<%= @agent %>.channels.<%= @c %>.type = memory
<%= @agent %>.channels.<%= @c %>.capacity = 1000
<%= @agent %>.channels.<%= @c %>.transactionCapacity = 1000